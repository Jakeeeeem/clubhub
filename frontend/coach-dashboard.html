<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Dashboard | ClubHub</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <header class="header">
        <nav class="nav container" id="loggedInNav">
            <div class="logo" onclick="window.location.href='index.html'">
                <img src="images/logo.png" alt="ClubHub Logo" class="logo-image">
                <span class="logo-text neon-text">ClubHub</span>
            </div>

            <div id="org-switcher-container"></div>

            <div class="user-info">
                <div class="user-avatar" id="coachAvatar">C</div>
                <span id="coachNameDisplay">Coach</span>
                <button onclick="logout()" class="btn btn-secondary btn-small">Logout</button>
            </div>
        </nav>
    </header>

    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="dashboard-nav">
                <button class="active" onclick="showCoachSection('overview')">üìä Overview</button>
                <button onclick="showCoachSection('teams')">üìã My Teams</button>
                <button onclick="showCoachSection('players')">üë• My Players</button>
                <button onclick="showCoachSection('events')">üìÖ Schedule</button>
                <button onclick="showCoachSection('tactical-board')">üìù Tactics</button>
                <button onclick="showCoachSection('profile')">üë§ My Profile</button>
                <button onclick="window.location.href='coach-settings.html'">‚öôÔ∏è Settings</button>
            </div>
        </aside>

        <main class="dashboard-content">
            <!-- Overview Section -->
            <div id="coach-overview" class="dashboard-section active">
                <div class="stats-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="stat-card">
                        <span class="stat-number" id="managedTeamsCount">0</span>
                        <span class="stat-label">Teams Managed</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="totalPlayersCount">0</span>
                        <span class="stat-label">Total Players</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="upcomingSessionsCount">0</span>
                        <span class="stat-label">Upcoming Sessions</span>
                    </div>
                </div>

                <div class="card">
                    <h3>Recent Groups</h3>
                    <div id="groupsContainer">
                        <p class="loading-text">Loading groups...</p>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="coach-profile" class="dashboard-section">
                <div class="card">
                    <div class="section-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h3>üë§ Coach Profile</h3>
                        <button class="btn-primary" onclick="saveCoachProfile()">Save Changes</button>
                    </div>
                    <form id="coachProfileForm">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div class="form-group">
                                <label>First Name</label>
                                <input type="text" id="coach-prof-firstName" required>
                            </div>
                            <div class="form-group">
                                <label>Last Name</label>
                                <input type="text" id="coach-prof-lastName" required>
                            </div>
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" id="coach-prof-email" readonly style="opacity: 0.6;">
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" id="coach-prof-phone">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label>Bio / Experience</label>
                                <textarea id="coach-prof-bio" rows="4"
                                    style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; padding: 0.8rem;"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Other placeholders for JS logic -->
            <div id="coach-teams" class="dashboard-section">
                <div class="card">
                    <h3>My Teams</h3>
                    <div id="coachTeamsList"></div>
                </div>
            </div>
            <div id="coach-players" class="dashboard-section">
                <div class="card">
                    <h3>Active Rosters</h3>
                    <div id="coachPlayersList"></div>
                </div>
            </div>
            <div id="coach-events" class="dashboard-section">
                <div class="card">
                    <h3>Training & Match Schedule</h3>
                    <div id="coachEventsList"></div>
                </div>
            </div>
            <div id="coach-tactical-board" class="dashboard-section">
                <div class="card">
                    <h3>Formation & Tactics</h3>
                    <div id="tacticalBoard"></div>
                </div>
            </div>

        </main>
    </div>

    <!-- Core Dependencies -->
    <script src="api-service.js"></script>
    <script src="script.js"></script>
    <script src="org-switcher.js"></script>
    <script src="coach-dashboard.js"></script>

    <script>
        window.addEventListener('load', () => {
            if (typeof initializeCoachDashboard === 'function') {
                initializeCoachDashboard();
            }

            // Set name display
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user) {
                document.getElementById('coachNameDisplay').textContent = user.firstName || user.first_name || 'Coach';
                if (document.getElementById('coachAvatar')) {
                    document.getElementById('coachAvatar').textContent = (user.firstName || user.first_name || 'C').charAt(0).toUpperCase();
                }
            }
        });

        function logout() {
            localStorage.clear();
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>